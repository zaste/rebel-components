<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rebel Components - Complete E-commerce Example</title>
  
  <!-- Rebel Design System -->
  <link rel="stylesheet" href="../design-system/tokens.css">
  
  <style>
    /* Page layout styles */
    body {
      font-family: var(--rebel-font-family-sans);
      margin: 0;
      padding: 0;
      background: var(--rebel-surface-alt);
      color: var(--rebel-text);
    }
    
    .page-header {
      background: var(--rebel-surface);
      border-bottom: 1px solid var(--rebel-border);
      padding: var(--rebel-spacing-3);
      margin-bottom: var(--rebel-spacing-4);
    }
    
    .page-title {
      font-size: var(--rebel-text-2xl);
      font-weight: var(--rebel-font-bold);
      margin: 0 0 var(--rebel-spacing-2);
    }
    
    .page-description {
      color: var(--rebel-text-secondary);
      margin: 0;
    }
    
    .demo-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 var(--rebel-spacing-3);
    }
    
    .demo-section {
      background: var(--rebel-surface);
      border-radius: var(--rebel-radius-lg);
      padding: var(--rebel-spacing-4);
      margin-bottom: var(--rebel-spacing-4);
      box-shadow: var(--rebel-shadow-sm);
    }
    
    .section-title {
      font-size: var(--rebel-text-lg);
      font-weight: var(--rebel-font-semibold);
      margin: 0 0 var(--rebel-spacing-3);
      color: var(--rebel-text);
    }
    
    .demo-actions {
      display: flex;
      gap: var(--rebel-spacing-2);
      margin-bottom: var(--rebel-spacing-3);
      flex-wrap: wrap;
    }
    
    .demo-button {
      padding: var(--rebel-spacing-2) var(--rebel-spacing-3);
      background: var(--rebel-primary);
      color: var(--rebel-text-inverse);
      border: none;
      border-radius: var(--rebel-radius-md);
      cursor: pointer;
      transition: var(--rebel-duration-fast);
      font-family: inherit;
      font-weight: var(--rebel-font-medium);
    }
    
    .demo-button:hover {
      background: var(--rebel-primary-hover);
    }
    
    .demo-button--secondary {
      background: var(--rebel-surface-alt);
      color: var(--rebel-text);
      border: 1px solid var(--rebel-border);
    }
    
    .demo-button--secondary:hover {
      background: var(--rebel-hover);
    }
    
    .layout-grid {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: var(--rebel-spacing-4);
      margin-top: var(--rebel-spacing-4);
    }
    
    @media (max-width: 768px) {
      .layout-grid {
        grid-template-columns: 1fr;
        gap: var(--rebel-spacing-3);
      }
      
      .demo-actions {
        flex-direction: column;
      }
    }
    
    /* Sample product data styles */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: var(--rebel-spacing-3);
      margin-top: var(--rebel-spacing-3);
    }
    
    .product-card {
      background: var(--rebel-surface);
      border: 1px solid var(--rebel-border);
      border-radius: var(--rebel-radius-md);
      padding: var(--rebel-spacing-3);
      transition: var(--rebel-duration-fast);
    }
    
    .product-card:hover {
      box-shadow: var(--rebel-shadow-md);
      transform: translateY(-2px);
    }
    
    .product-image {
      width: 100%;
      height: 200px;
      background: var(--rebel-surface-secondary);
      border-radius: var(--rebel-radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: var(--rebel-spacing-2);
      color: var(--rebel-text-secondary);
    }
    
    .product-title {
      font-weight: var(--rebel-font-semibold);
      margin: 0 0 var(--rebel-spacing-1);
    }
    
    .product-price {
      color: var(--rebel-primary);
      font-weight: var(--rebel-font-bold);
      margin: 0 0 var(--rebel-spacing-2);
    }
    
    .product-category {
      display: inline-block;
      background: var(--rebel-surface-alt);
      color: var(--rebel-text-secondary);
      padding: var(--rebel-spacing-1) var(--rebel-spacing-2);
      border-radius: var(--rebel-radius-full);
      font-size: var(--rebel-text-xs);
      margin-bottom: var(--rebel-spacing-2);
    }
  </style>
</head>
<body>
  
  <!-- Page Header -->
  <header class="page-header">
    <h1 class="page-title">E-commerce Product Catalog</h1>
    <p class="page-description">
      Complete example showing Filter + Modal + Toast components working together
    </p>
  </header>
  
  <!-- Demo Container -->
  <div class="demo-container">
    
    <!-- Demo Actions Section -->
    <div class="demo-section">
      <h2 class="section-title">Interactive Demo</h2>
      <div class="demo-actions">
        <button class="demo-button" onclick="showWelcomeModal()">
          Welcome Modal
        </button>
        <button class="demo-button demo-button--secondary" onclick="showSuccessToast()">
          Success Toast
        </button>
        <button class="demo-button demo-button--secondary" onclick="showErrorToast()">
          Error Toast
        </button>
        <button class="demo-button demo-button--secondary" onclick="resetFilters()">
          Reset Filters
        </button>
        <button class="demo-button demo-button--secondary" onclick="addSampleProducts()">
          Load Sample Data
        </button>
      </div>
    </div>
    
    <!-- Main Layout Grid -->
    <div class="layout-grid">
      
      <!-- Sidebar with Filter -->
      <aside>
        <div class="demo-section">
          <h2 class="section-title">Filter Products</h2>
          
          <!-- REBEL FILTER COMPONENT -->
          <div data-cs="rebel-filter" 
               id="product-filter"
               data-variant="compact"
               data-persist="true"
               data-announcements="true">
            
            <!-- Filter will auto-generate search and tag controls -->
            
          </div>
          
        </div>
      </aside>
      
      <!-- Main Content Area -->
      <main>
        <div class="demo-section">
          <h2 class="section-title">Products</h2>
          
          <!-- Product Grid (Filtered Results) -->
          <div id="product-results" class="product-grid">
            <div class="product-card">
              <div class="product-image">Loading products...</div>
              <div class="product-title">Click "Load Sample Data" to see products</div>
              <div class="product-price">$0.00</div>
            </div>
          </div>
          
        </div>
      </main>
      
    </div>
    
  </div>
  
  <!-- REBEL MODAL COMPONENT -->
  <div data-cs="rebel-modal" 
       id="welcome-modal"
       data-close-escape="true"
       data-close-backdrop="true"
       data-variant="default">
    
    <div data-slot="content">
      <h3>Welcome to Our Store!</h3>
      <p>Discover amazing products with our intelligent filtering system.</p>
      <p><strong>Try these features:</strong></p>
      <ul>
        <li>üîç Search products by name or description</li>
        <li>üè∑Ô∏è Filter by category tags</li>
        <li>üì± Fully responsive on mobile</li>
        <li>‚ôø Accessible via keyboard and screen readers</li>
        <li>‚ö° Debounced search for smooth performance</li>
      </ul>
      <p><em>All components work together seamlessly!</em></p>
    </div>
    
    <div data-slot="footer">
      <button type="button" class="modal__button" data-action="cancel">
        Maybe Later
      </button>
      <button type="button" class="modal__button modal__button--primary" data-action="confirm">
        Let's Explore!
      </button>
    </div>
    
  </div>
  
  <!-- REBEL TOAST COMPONENT -->
  <div data-cs="rebel-toast" 
       id="notification-toast"
       data-position="top-right"
       data-auto-dismiss="4000">
    
    <div data-slot="content">
      <div class="toast-message">
        <strong data-text="title">Notification</strong>
        <p data-text="message">This is a sample notification message.</p>
      </div>
    </div>
    
  </div>
  
  <!-- Include Rebel Components -->
  <script>
    // Sample product data
    const sampleProducts = [
      {
        id: 1,
        title: "Wireless Headphones",
        price: "$99.99",
        category: "Electronics",
        tags: ["electronics", "audio", "wireless"],
        description: "High-quality wireless headphones with noise cancellation"
      },
      {
        id: 2,
        title: "Organic Coffee Beans",
        price: "$24.99",
        category: "Food & Beverage",
        tags: ["food", "coffee", "organic"],
        description: "Premium organic coffee beans from sustainable farms"
      },
      {
        id: 3,
        title: "Yoga Mat",
        price: "$39.99",
        category: "Fitness",
        tags: ["fitness", "yoga", "equipment"],
        description: "Non-slip yoga mat perfect for all types of exercise"
      },
      {
        id: 4,
        title: "Smart Watch",
        price: "$199.99",
        category: "Electronics",
        tags: ["electronics", "wearable", "smart"],
        description: "Feature-rich smartwatch with health monitoring"
      },
      {
        id: 5,
        title: "Ceramic Mug Set",
        price: "$34.99",
        category: "Home & Kitchen",
        tags: ["home", "kitchen", "ceramic"],
        description: "Beautiful handcrafted ceramic mugs, set of 4"
      },
      {
        id: 6,
        title: "Running Shoes",
        price: "$89.99",
        category: "Sports",
        tags: ["sports", "running", "shoes"],
        description: "Lightweight running shoes with superior comfort"
      },
      {
        id: 7,
        title: "Desk Lamp",
        price: "$45.99",
        category: "Home & Office",
        tags: ["home", "office", "lighting"],
        description: "Adjustable LED desk lamp with touch controls"
      },
      {
        id: 8,
        title: "Protein Powder",
        price: "$54.99",
        category: "Health & Fitness",
        tags: ["fitness", "protein", "supplement"],
        description: "Premium whey protein powder for muscle building"
      }
    ];
    
    // Demo functions
    function showWelcomeModal() {
      const modal = document.getElementById('welcome-modal')._instance;
      if (modal) {
        modal.open();
      }
    }
    
    function showSuccessToast() {
      const toast = document.getElementById('notification-toast')._instance;
      if (toast) {
        toast.show({
          title: "Success!",
          message: "Your action was completed successfully.",
          type: "success"
        });
      }
    }
    
    function showErrorToast() {
      const toast = document.getElementById('notification-toast')._instance;
      if (toast) {
        toast.show({
          title: "Error",
          message: "Something went wrong. Please try again.",
          type: "error"
        });
      }
    }
    
    function resetFilters() {
      const filter = document.getElementById('product-filter')._instance;
      if (filter) {
        filter.clearAllFilters();
        showSuccessToast();
      }
    }
    
    function addSampleProducts() {
      const filter = document.getElementById('product-filter')._instance;
      if (filter) {
        // Set filter data
        filter.setItems(sampleProducts);
        
        // Generate tag options from product categories
        const categories = [...new Set(sampleProducts.map(p => p.category))];
        const tags = categories.map(category => ({
          label: category,
          value: category.toLowerCase().replace(/\s+/g, '-'),
          count: sampleProducts.filter(p => p.category === category).length
        }));
        
        filter.setTags(tags);
        
        // Listen for filter updates
        filter.on('results-updated', (event) => {
          const { items, count } = event.detail;
          renderProducts(items);
          
          // Show toast with results count
          const toast = document.getElementById('notification-toast')._instance;
          if (toast) {
            toast.show({
              title: "Filters Updated",
              message: `Found ${count} matching products`,
              type: "info"
            });
          }
        });
        
        // Initial render
        renderProducts(sampleProducts);
        
        showSuccessToast();
      }
    }
    
    function renderProducts(products) {
      const container = document.getElementById('product-results');
      
      if (products.length === 0) {
        container.innerHTML = `
          <div class="product-card">
            <div class="product-image">No products found</div>
            <div class="product-title">Try adjusting your filters</div>
            <div class="product-price">$0.00</div>
          </div>
        `;
        return;
      }
      
      container.innerHTML = products.map(product => `
        <div class="product-card" onclick="showProductModal('${product.id}')">
          <div class="product-image">üì¶ Product Image</div>
          <div class="product-category">${product.category}</div>
          <div class="product-title">${product.title}</div>
          <div class="product-price">${product.price}</div>
        </div>
      `).join('');
    }
    
    function showProductModal(productId) {
      const product = sampleProducts.find(p => p.id == productId);
      if (!product) return;
      
      // Create dynamic modal content
      const modal = document.getElementById('welcome-modal')._instance;
      if (modal) {
        modal.setTitle(product.title);
        modal.setContent(`
          <div style="text-align: center;">
            <div style="width: 100%; height: 200px; background: var(--rebel-surface-secondary); border-radius: var(--rebel-radius-md); display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; color: var(--rebel-text-secondary);">
              üì¶ ${product.title}
            </div>
            <h3>${product.title}</h3>
            <p style="color: var(--rebel-primary); font-size: 1.5rem; font-weight: bold; margin: 1rem 0;">
              ${product.price}
            </p>
            <p style="color: var(--rebel-text-secondary); margin-bottom: 1rem;">
              ${product.description}
            </p>
            <div style="margin: 1rem 0;">
              <span style="background: var(--rebel-surface-alt); color: var(--rebel-text-secondary); padding: 0.25rem 0.5rem; border-radius: var(--rebel-radius-full); font-size: 0.875rem;">
                ${product.category}
              </span>
            </div>
          </div>
        `);
        
        modal.open();
      }
    }
    
    // Initialize with welcome modal after a short delay
    setTimeout(() => {
      if (document.getElementById('welcome-modal')._instance) {
        showWelcomeModal();
      }
    }, 1000);
    
    // Also load sample data automatically
    setTimeout(() => {
      addSampleProducts();
    }, 500);
  </script>
  
  <!-- Load Rebel Components -->
  <!-- Filter Component -->
  <script>
    // Filter component would be loaded here
    // For demo purposes, we'll create a simplified version
    
    if (!document.querySelector('[data-cs="rebel-filter"]')._instance) {
      // Simple filter implementation for demo
      const filterEl = document.querySelector('[data-cs="rebel-filter"]');
      filterEl.innerHTML = `
        <div style="margin-bottom: 1rem;">
          <label style="display: block; font-weight: 500; margin-bottom: 0.5rem;">Search Products</label>
          <input type="search" 
                 placeholder="Type to search..." 
                 style="width: 100%; padding: 0.75rem; border: 1px solid var(--rebel-border); border-radius: var(--rebel-radius-md); font-family: inherit;"
                 oninput="demoFilter(this.value)">
        </div>
        <div>
          <label style="display: block; font-weight: 500; margin-bottom: 0.5rem;">Categories</label>
          <div id="category-filters"></div>
        </div>
        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--rebel-border);">
          <button onclick="demoClearFilters()" 
                  style="width: 100%; padding: 0.5rem; background: var(--rebel-surface-alt); border: 1px solid var(--rebel-border); border-radius: var(--rebel-radius-md); cursor: pointer;">
            Clear All Filters
          </button>
        </div>
      `;
      
      // Mock filter instance
      filterEl._instance = {
        setItems: function(items) {
          this.items = items;
          this.filteredItems = items;
        },
        setTags: function(tags) {
          const container = document.getElementById('category-filters');
          container.innerHTML = tags.map(tag => `
            <label style="display: block; margin-bottom: 0.5rem; cursor: pointer;">
              <input type="checkbox" value="${tag.value}" onchange="demoTagFilter()" style="margin-right: 0.5rem;">
              ${tag.label} (${tag.count})
            </label>
          `).join('');
        },
        clearAllFilters: function() {
          demoClearFilters();
        },
        on: function(event, handler) {
          this.handlers = this.handlers || {};
          this.handlers[event] = handler;
        },
        emit: function(event, data) {
          if (this.handlers && this.handlers[event]) {
            this.handlers[event]({ detail: data });
          }
        }
      };
    }
    
    let currentSearchTerm = '';
    let selectedCategories = new Set();
    
    function demoFilter(searchTerm) {
      currentSearchTerm = searchTerm.toLowerCase();
      applyFilters();
    }
    
    function demoTagFilter() {
      const checkboxes = document.querySelectorAll('#category-filters input[type="checkbox"]');
      selectedCategories.clear();
      checkboxes.forEach(cb => {
        if (cb.checked) {
          selectedCategories.add(cb.value);
        }
      });
      applyFilters();
    }
    
    function demoClearFilters() {
      currentSearchTerm = '';
      selectedCategories.clear();
      document.querySelector('[data-cs="rebel-filter"] input[type="search"]').value = '';
      document.querySelectorAll('#category-filters input[type="checkbox"]').forEach(cb => {
        cb.checked = false;
      });
      applyFilters();
    }
    
    function applyFilters() {
      const filter = document.getElementById('product-filter')._instance;
      if (!filter || !filter.items) return;
      
      let filtered = filter.items.filter(product => {
        const matchesSearch = !currentSearchTerm || 
                            product.title.toLowerCase().includes(currentSearchTerm) ||
                            product.description.toLowerCase().includes(currentSearchTerm);
        
        const matchesCategory = selectedCategories.size === 0 ||
                               selectedCategories.has(product.category.toLowerCase().replace(/\s+/g, '-'));
        
        return matchesSearch && matchesCategory;
      });
      
      filter.emit('results-updated', {
        items: filtered,
        count: filtered.length,
        isEmpty: filtered.length === 0
      });
    }
  </script>
  
  <!-- Toast Component Mock -->
  <script>
    if (!document.querySelector('[data-cs="rebel-toast"]')._instance) {
      const toastEl = document.querySelector('[data-cs="rebel-toast"]');
      toastEl.style.cssText = `
        position: fixed;
        top: 1rem;
        right: 1rem;
        z-index: 1000;
        display: none;
        background: var(--rebel-surface);
        border: 1px solid var(--rebel-border);
        border-radius: var(--rebel-radius-md);
        padding: 1rem;
        box-shadow: var(--rebel-shadow-lg);
        max-width: 300px;
        transition: all 0.3s ease;
      `;
      
      toastEl._instance = {
        show: function(options) {
          const { title, message, type = 'info' } = options;
          
          const colors = {
            success: 'var(--rebel-success)',
            error: 'var(--rebel-error)',
            info: 'var(--rebel-primary)'
          };
          
          toastEl.style.borderLeftColor = colors[type];
          toastEl.style.borderLeftWidth = '4px';
          toastEl.innerHTML = `
            <div style="font-weight: 600; margin-bottom: 0.25rem;">${title}</div>
            <div style="color: var(--rebel-text-secondary); font-size: 0.875rem;">${message}</div>
          `;
          
          toastEl.style.display = 'block';
          
          setTimeout(() => {
            toastEl.style.display = 'none';
          }, 4000);
        }
      };
    }
  </script>
  
  <!-- Modal Component Mock -->
  <script>
    if (!document.querySelector('[data-cs="rebel-modal"]')._instance) {
      const modalEl = document.querySelector('[data-cs="rebel-modal"]');
      modalEl.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        padding: 1rem;
      `;
      
      const container = modalEl.querySelector('.modal__container') || document.createElement('div');
      container.style.cssText = `
        background: var(--rebel-surface);
        border-radius: var(--rebel-radius-lg);
        max-width: 500px;
        width: 100%;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: var(--rebel-shadow-2xl);
        transform: scale(0.95);
        transition: transform 0.3s ease;
      `;
      
      modalEl._instance = {
        open: function() {
          modalEl.style.display = 'flex';
          setTimeout(() => {
            container.style.transform = 'scale(1)';
          }, 10);
        },
        close: function() {
          container.style.transform = 'scale(0.95)';
          setTimeout(() => {
            modalEl.style.display = 'none';
          }, 300);
        },
        setTitle: function(title) {
          const titleEl = modalEl.querySelector('[data-text="title"]') || 
                          modalEl.querySelector('.modal__title') ||
                          modalEl.querySelector('h3');
          if (titleEl) titleEl.textContent = title;
        },
        setContent: function(content) {
          const contentEl = modalEl.querySelector('[data-slot="content"]');
          if (contentEl) contentEl.innerHTML = content;
        }
      };
      
      // Close on backdrop click
      modalEl.addEventListener('click', (e) => {
        if (e.target === modalEl) {
          modalEl._instance.close();
        }
      });
      
      // Close on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modalEl.style.display === 'flex') {
          modalEl._instance.close();
        }
      });
      
      // Setup modal buttons
      modalEl.addEventListener('click', (e) => {
        if (e.target.matches('[data-action="cancel"]') || e.target.matches('[data-action="confirm"]')) {
          modalEl._instance.close();
        }
      });
    }
  </script>
  
</body>
</html>
